<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/tufte.css">
<link rel="stylesheet" href="/css/latex.css">
<link rel="stylesheet" href="/css/adjust.css"> <!-- sheet to overwrite some clashing styles -->
<link rel="icon" href="/assets/favicon.png">

     <title>Machine Learning (curve fitting) Bezier curves with Enzyme AD and WASM</title>  
</head>

<body>
<div id="layout">
  <div id="menu">
    <ul>
      <li><a href="/">Home</a></li>
      <!-- <li><a href="/menu1/">writings</a></li>
      <li><a href="/menu2/">Projects</a></li>
      <li><a href="/menu4/">miscs</a></li>
      <li><a href="/javisstuff/">Javis Tutorials</a></li>-->
    </ul>
  </div>
  <div id="main">



<!-- Content appended here -->
<div class="franklin-content"><h1 id="machine_learning_curve_fitting_bezier_curves_with_enzyme_ad_and_wasm"><a href="#machine_learning_curve_fitting_bezier_curves_with_enzyme_ad_and_wasm" class="header-anchor">&quot;Machine Learning&quot; &#40;curve fitting&#41; Bezier curves with Enzyme AD and WASM</a></h1>
<p><a href="/thangs/freehandbezier">Check it out here</a></p>
<p>Calling this machine learning is really a stretch but i guess its close enough. The idea here is a canvas on which one can draw curves, and a program finds the closest possible cubic bezier and render it on an SVG.  There exists a &quot;loss value&quot; which is the distance of the curve points from a bezier curve. The bezier with the smallest loss value will have the points of the drawn curve closest to it . It turns out one can have a closed form solution to the minima as shown <a href="https://www.jimherold.com/computer-science/best-fit-bezier-curve">here</a> , but i wanted to try my hand at using gradient descent with <a href="https://enzyme.mit.edu/">Enzyme AD</a> in WASM, and here we are. &#40;besides, I see a matrix inversion in that blog post, which almost certainly would have to use an algorithm that is iterative&#41;.</p>
<p>The gradient descent curve fitting is written in C and compiled to WASM to run in the browser. For automatic differentation the excellent Enzyme AD is used. Enzyme can perform AD on LLVM IR the intermediate representation that clang compiler produces before compiling it all down to WASM.</p>
<p>It isn&#39;t perfect ofcourse, for one drawing a really complex curvy shape may not find a good fit to a bezier after all. Thats expected i guess since curves with more than two &quot;squigles&quot; cannot certainly be made by a cubic bezier. Sometimes even simple curves dont fit very well. But for the most part it looks good , and its kinda satisfying to see a smooth curve overlay over the jagged lines that one draws</p>
<p>Maybe sometime i&#39;ll sit down and explain it all in a post but till then source can be found <a href="http://github.com/arbitrandomuser/freehandbezier">here</a>. </p>
<p><a href="/thangs/freehandbezier">Check it out here</a></p>
<p><img src="/assets/bezier2.png" alt="" /> <img src="/assets/bezier.png" alt="" /></p>
<div class="page-foot">
  <div class="copyright">
    &copy; John George Francis. Last modified: August 26, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>, theme modified from tuftecss.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
        </div> <!-- end of id=main -->
    </div> <!-- end of id=layout -->
    
    
  </body>
</html>
