(function(){"use strict";let e;importScripts("https://cdn.jsdelivr.net/pyodide/v0.23.0/full/pyodide.js");async function n(){e=await loadPyodide(),console.log("pyodide loaded"),await e.loadPackage(["numpy","pytz"]),self.postMessage({type:"pyodideready"})}let i=n();onmessage=async a=>{await i;try{a.data.run!="first"&&await e.runPython("clearobjects()"),await e.runPython(a.data.code);let o=await e.runPython("makescenejson()"),r=JSON.parse(o).shader;postMessage({shaderstring:r})}catch(o){const s=o.message;let t;const r=s.indexOf('File "<exec>"');r!==-1?t=s.substring(r):t=s.split(`
`).filter(d=>d.trim()!=="").pop()||"An unknown Python error occurred.",console.log(s),postMessage({error:{message:t}})}}})();
